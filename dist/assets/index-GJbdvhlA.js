var T=Object.defineProperty;var R=(h,t,e)=>t in h?T(h,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[t]=e;var l=(h,t,e)=>R(h,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();class q{constructor(t,e,o,i,s){l(this,"bbox");l(this,"action_type");l(this,"loc");l(this,"text");l(this,"text_size");l(this,"state");t.font=r.label.font_size+"px "+r.font,t.textBaseline="middle";const n=t.measureText(s),c=n.width,a=n.fontBoundingBoxAscent+n.fontBoundingBoxDescent;this.bbox={left:i.x,top:i.y,right:i.x+c,bottom:i.y+a},this.text=s,this.action_type=e,this.text_size=r.label.font_size,this.state=0,this.loc=o}render(t){let e=w.string(w.white);this.state==1&&(e=r.widget.hover_bg_color),t.font=this.text_size+"px "+r.font,t.fillStyle=e,t.textBaseline="middle",t.textAlign="center";const o=(this.bbox.left+this.bbox.right)/2,i=(this.bbox.top+this.bbox.bottom)/2;t.fillText(this.text,o,i)}requestAction(t){if(this.action_type==null)return{wants_focus:!1,action:null};const[e,o]=[t.mouse_position.x,t.mouse_position.y];return d.isInside(this.bbox,e,o)&&this.action_type!=null&&(this.state=1),this.state==1?{wants_focus:t.mouse_frame.clicked,action:this.action_type}:{wants_focus:!1,action:null}}}var S=(h=>(h[h.default=0]="default",h[h.hovered=1]="hovered",h[h.clicked=2]="clicked",h[h.down=3]="down",h[h.released=4]="released",h))(S||{});class M{constructor(t,e,o,i,s,n,c){l(this,"bbox");l(this,"action_type");l(this,"loc");l(this,"text");l(this,"state");t.font=r.button.font_size+"px "+r.font,t.textBaseline="middle";const a=t.measureText(s),f=a.width+2*r.button.padding,_=n!=null&&n>f?n:f,m=a.fontBoundingBoxAscent+a.fontBoundingBoxDescent+2*r.button.padding,y=c!=null&&c>m?c:m;this.bbox={left:i.x,top:i.y,right:i.x+_,bottom:i.y+y},this.text=s,this.action_type=e,this.state=0,this.loc=o}render(t){let e=r.widget.default_bg_color;this.state==1&&(e=r.widget.hover_bg_color),this.state==2&&(e=r.widget.down_bg_color),this.state==3&&(e=r.widget.down_bg_color),this.state==4&&(e=r.widget.down_bg_color),t.fillStyle=e,t.fillRect(this.bbox.left,this.bbox.top,d.calcWidth(this.bbox),d.calcHeight(this.bbox)),t.font=`normal ${r.button.font_size}px ${r.font}`,t.fillStyle=w.string(w.white),t.textBaseline="middle",t.textAlign="center";const o=(this.bbox.left+this.bbox.right)/2,i=(this.bbox.top+this.bbox.bottom)/2;t.fillText(this.text,o,i)}requestAction(t){if(this.action_type==null)return{wants_focus:!1,action:null};const[e,o]=[t.mouse_position.x,t.mouse_position.y];if(d.isInside(this.bbox,e,o)){const i=JSON.stringify(t.active_widget_loc)==JSON.stringify(this.loc);t.mouse_frame.clicked?(this.state=2,t.active_widget_loc=JSON.parse(JSON.stringify(this.loc))):i&&t.mouse_frame.released?this.state=4:i&&t.mouse_down?this.state=3:this.state=1}return this.state==2||this.state==3?{wants_focus:!0,action:null}:this.state==4?{wants_focus:!1,action:this.action_type}:{wants_focus:!1,action:null}}}class C{constructor(t,e,o,i,s,n){l(this,"bbox");l(this,"action_type");l(this,"loc");l(this,"text");l(this,"state");t.font=r.button.font_size+"px "+r.font,t.textBaseline="middle";const c=t.measureText(s),a=c.width,f=c.fontBoundingBoxAscent+c.fontBoundingBoxDescent;this.bbox={left:i.x,top:i.y,right:i.x+(n||a+2*r.button.padding),bottom:i.y+f+2*r.button.padding},this.text=s,this.action_type=e,this.state=0,this.loc=o}render(t){let e=r.widget.default_bg_color;this.state==1&&(e=r.widget.hover_bg_color),this.state==2&&(e=r.widget.down_bg_color),this.state==3&&(e=r.widget.down_bg_color),this.state==4&&(e=r.widget.down_bg_color),t.fillStyle=e,t.fillRect(this.bbox.left,this.bbox.top,d.calcWidth(this.bbox),d.calcHeight(this.bbox)),t.font="lighter "+r.button.font_size+"px "+r.font,t.fillStyle=w.string(w.white),t.textBaseline="middle",t.textAlign="center";const o=Math.round((this.bbox.left+this.bbox.right)/2)+.5,i=Math.round((this.bbox.top+this.bbox.bottom)/2)+1;t.fillText(this.text,o,i)}requestAction(t){if(this.action_type==null)return{wants_focus:!1,action:null};const[e,o]=[t.mouse_position.x,t.mouse_position.y],i=d.isInside(this.bbox,e,o);return i&&t.mouse_frame.clicked?(this.state=2,t.active_widget_loc=JSON.parse(JSON.stringify(this.loc))):JSON.stringify(t.active_widget_loc)==JSON.stringify(this.loc)&&t.mouse_frame.released?this.state=4:JSON.stringify(t.active_widget_loc)==JSON.stringify(this.loc)&&t.mouse_down?this.state=3:i&&(this.state=1),this.state==2||this.state==3?{wants_focus:!0,action:this.action_type}:this.state==4?{wants_focus:!1,action:null}:{wants_focus:!1,action:null}}}class F{constructor(t,e,o,i,s,n){l(this,"bbox");l(this,"action_type");l(this,"loc");l(this,"text");l(this,"text_size");l(this,"max_width");l(this,"state");l(this,"wrapped_lines");t.font=r.text.font_size+"px "+r.font,t.textBaseline="middle",this.max_width=n,this.text=s,this.action_type=e,this.text_size=r.text.font_size,this.state=0,this.loc=o,this.wrapped_lines=this.wrapText(t,s,n);let c=0;for(let _=0;_<this.wrapped_lines.length;_++){const m=t.measureText(this.wrapped_lines[_]).width;c<m&&(c=m)}const a=this.text_size*r.text.text_height_mult,f=this.wrapped_lines.length*a;this.bbox={left:i.x,top:i.y,right:i.x+c,bottom:i.y+f}}wrapText(t,e,o){const i=e.split(" "),s=[];let n="";for(let c of i){const a=n+(n?" ":"")+c;t.measureText(a).width>o?(n&&s.push(n),n=c):n=a}return n&&s.push(n),s}render(t){let e=w.string(w.white);this.state==1&&(e=r.widget.hover_bg_color),t.font=this.text_size+"px "+r.font,t.fillStyle=e,t.textBaseline="middle",t.textAlign="left";const o=this.text_size*1.2;let i=this.bbox.top+o/2;for(let s of this.wrapped_lines){const n=this.bbox.left;t.fillText(s,n,i),i+=o}}requestAction(t){if(this.action_type==null)return{wants_focus:!1,action:null};const[e,o]=[t.mouse_position.x,t.mouse_position.y];return d.isInside(this.bbox,e,o)&&this.action_type!=null&&(this.state=1),this.state==1?{wants_focus:t.mouse_frame.clicked,action:this.action_type}:{wants_focus:!1,action:null}}}class J{constructor(t,e,o,i,s,n){l(this,"bbox");l(this,"action_type");l(this,"loc");l(this,"color");this.color=i,this.bbox={left:o.x,top:o.y,right:o.x+s,bottom:o.y+n},this.action_type=t,this.loc=e}render(t){const e=d.calcWidth(this.bbox),o=d.calcHeight(this.bbox),i=w.toHSVA(this.color),s={h:i.h,s:i.s,v:i.v,a:i.a};s.s=1,s.v=1;const n=w.string(w.fromHSVA(s.h,s.s,s.v,s.a)),c=t.createLinearGradient(this.bbox.left,this.bbox.top,this.bbox.right,this.bbox.top);c.addColorStop(0,"white"),c.addColorStop(1,n),t.fillStyle=c,t.fillRect(this.bbox.left,this.bbox.top,e,o);const a=t.createLinearGradient(this.bbox.left,this.bbox.top,this.bbox.left,this.bbox.bottom);a.addColorStop(0,"rgba(0, 0, 0, 0)"),a.addColorStop(1,"rgba(0, 0, 0, 1)"),t.fillStyle=a,t.fillRect(this.bbox.left,this.bbox.top,e,o);const f=i.s*e+this.bbox.left,_=(1-i.v)*o+this.bbox.top;t.beginPath(),t.arc(f,_,5,0,2*Math.PI),t.fillStyle=w.string(this.color),t.fill(),t.lineWidth=3,t.strokeStyle="black",t.stroke(),t.lineWidth=2,t.strokeStyle="white",t.stroke(),t.closePath()}requestAction(t){if(this.action_type==null)return{wants_focus:!1,action:null};const[e,o]=[t.mouse_position.x,t.mouse_position.y];if(d.isInside(this.bbox,e,o)&&t.mouse_frame.clicked&&(t.active_widget_loc=this.loc),JSON.stringify(t.active_widget_loc)==JSON.stringify(this.loc)&&t.mouse_down){const n=d.calcWidth(this.bbox),c=d.calcHeight(this.bbox),a=v=>Math.min(Math.max(v,.0015),.999),f=a((e-this.bbox.left)/n),_=a(1-(o-this.bbox.top)/c),m=w.toHSVA(this.color);let y;if(_===0)y=w.fromHSVA(m.h,f,0,this.color.a);else if(f===0)y=w.fromHSVA(m.h,0,_,this.color.a);else{const v=w.toHSVA(this.color);y=w.fromHSVA(v.h,f,_,this.color.a)}return this.color=y,t.action_ret_var=this.color,{wants_focus:!0,action:this.action_type}}return{wants_focus:!1,action:null}}}class A{constructor(t,e,o,i,s,n){l(this,"bbox");l(this,"action_type");l(this,"loc");l(this,"widgets");l(this,"cursor");this.cursor={x:o+r.layout_commons.padding,y:i},this.bbox={left:o,top:i,right:o+s,bottom:i+n},this.action_type=t,this.loc=e,this.widgets=[]}getInnerWidth(){return d.calcWidth(this.bbox)-2*r.layout_commons.padding}pushWidget(t){this.widgets.push(t)}render(t){for(let e=this.widgets.length-1;e>=0;e--)this.widgets[e].render(t)}requestAction(t){const e=n=>{if(t.active_widget_loc.length===0)return!0;const c=t.active_widget_loc.slice(0,n.loc.length);return c.length===n.loc.length&&c.every((a,f)=>a===n.loc[f])},[o,i]=[t.mouse_position.x,t.mouse_position.y],s=d.isInside(this.bbox,o,i);if(!s&&t.active_widget_loc.length==0)return{iters:null,wants_focus:!1,action:null};if(!t.moving_window)for(let n=0;n<this.widgets.length;n++){const c=this.widgets[n];if(!e(c))continue;const a=c.requestAction(t);if(a.wants_focus||a.action!=null||!(c instanceof A)&&d.isInside(c.bbox,o,i)&&c.action_type!=null&&!(c instanceof W))return{iters:n,wants_focus:a.wants_focus,action:a.action}}return t.active_widget_loc.length>1&&JSON.stringify(t.active_widget_loc)!=JSON.stringify(this.loc)?(t.active_widget_loc=[],{iters:null,wants_focus:!1,action:null}):this.action_type==null?{iters:null,wants_focus:!1,action:null}:(s&&t.mouse_frame.clicked&&(t.moving_window=!0,t.active_widget_loc=this.loc),t.moving_window&&t.mouse_frame.released&&(t.moving_window=!1,t.active_widget_loc=[]),{iters:null,wants_focus:!1,action:null})}makeLabel(t,e,o){const i=new q(t,e,this.loc.concat([this.widgets.length]),this.cursor,o);return this.pushWidget(i),i}makeButton(t,e,o,i){const s=new M(t,e,this.loc.concat([this.widgets.length]),this.cursor,o,i==null?void 0:i.width,i==null?void 0:i.height);return this.pushWidget(s),s}makeDraggable(t,e,o,i){const s=new C(t,e,this.loc.concat([this.widgets.length]),this.cursor,o,i==null?void 0:i.width);return this.pushWidget(s),s}makeText(t,e,o,i){const s=new F(t,e,this.loc.concat([this.widgets.length]),this.cursor,o,i??d.calcWidth(this.bbox)-2*r.layout_commons.padding);return this.pushWidget(s),s}makeColorPickerRect(t,e,o,i){const s=new J(t,this.loc.concat([this.widgets.length]),this.cursor,e,o,i);return this.pushWidget(s),s}resetCursor(){this.cursor.x=this.bbox.left+2*r.layout_commons.widget_gap,this.cursor.y=this.widgets[this.widgets.length-1].bbox.bottom+r.layout_commons.widget_gap}}class W{constructor(t,e,o,i,s,n){l(this,"bbox");l(this,"action_type");l(this,"loc");l(this,"widgets");l(this,"title");l(this,"title_font_size");l(this,"window_state");this.action_type=e,this.title=o,this.title_font_size=r.header_commons.font_size,this.bbox={left:i,top:s,right:i+n,bottom:s+1.4*r.header_commons.font_size},this.loc=t,this.widgets=[],this.window_state="open"}render(t){t.fillStyle=this.window_state=="open"?r.header_commons.bg_color:r.window.minimized_header_bg,t.fillRect(this.bbox.left,this.bbox.top,d.calcWidth(this.bbox),d.calcHeight(this.bbox)),t.font=this.title_font_size+"px "+r.font,t.fillStyle=r.header_commons.color,t.textBaseline="middle",t.textAlign="left";const e=this.bbox.left+r.layout_commons.widget_gap,o=(this.bbox.top+this.bbox.bottom)/2;t.fillText(this.title,e,o)}requestAction(t){if(this.action_type==null)return{wants_focus:!1,action:null};const[e,o]=[t.mouse_position.x,t.mouse_position.y];return d.isInside(this.bbox,e,o)&&t.mouse_frame.double_clicked?{wants_focus:!1,action:this.action_type}:{wants_focus:!1,action:null}}}class O extends C{constructor(t,e,o,i,s){super(t,e,o,i,s)}}class L extends M{constructor(t,e,o,i){super(t,e,o,i,"x")}render(t){let e=r.widget.default_bg_color;this.state==S.hovered&&(e=r.widget.hover_bg_color),this.state==S.clicked&&(e=r.widget.down_bg_color),this.state==S.down&&(e=r.widget.down_bg_color),this.state==S.released&&(e=r.widget.down_bg_color);const o=(this.bbox.left+this.bbox.right)/2;let i=(this.bbox.top+this.bbox.bottom)/2;i+=r.button.font_size*.1,t.fillStyle=e,t.beginPath(),t.arc(o,i,.5*r.button.font_size,0,2*Math.PI),t.fill(),t.closePath(),t.font=`normal ${1.25*r.button.font_size}px ${r.font}`,t.fillStyle=w.string(w.white),t.textBaseline="middle",t.textAlign="center",t.fillText(this.text,o,i)}}class H extends A{constructor(e,o,i,s,n,c,a,f,_,m,y,v){super(o,c,a,f,_,m);l(this,"min_size");l(this,"header_height");l(this,"offset");l(this,"mode");l(this,"tools");this.offset=0,this.mode="normal",this.tools={min_width:0,max_width:d.calcWidth(this.bbox)};const B=this.loc.concat([]);B.push(this.widgets.length),s!=null&&this.widgets.push(new O(e,s,B,{x:this.bbox.right-27,y:this.bbox.bottom-20},"res"));const E=this.loc.concat([]);E.push(this.widgets.length),n!=null&&this.widgets.push(new L(e,n,E,{x:this.bbox.right-15,y:this.bbox.top-2.5}));const N=c.concat([]);N.push(this.widgets.length);const z=new W(N,i,y,this.cursor.x,this.cursor.y,10);this.widgets.push(z),this.cursor.y+=d.calcHeight(z.bbox)+r.layout_commons.widget_gap,this.header_height=d.calcHeight(z.bbox),this.min_size=v,z.bbox.left=this.bbox.left,z.bbox.right=this.bbox.right}updateBBox(){}setMode(e,o){switch(this.mode=e,this.mode){case"normal":break;case"two columns":this.offset=this.widgets.length,o!=null&&(this.tools.min_width=o.min_width!=null?o.min_width:this.tools.min_width,this.tools.max_width=o.max_width!=null?o.max_width:this.tools.max_width);break}}pushWidget(e){switch(super.pushWidget(e),this.mode){case"normal":this.cursor.y+=d.calcHeight(e.bbox)+r.layout_commons.widget_gap;break;case"two columns":if((this.widgets.length-this.offset)%2==0){this.cursor.x=this.bbox.left+r.layout_commons.padding;const o=this.widgets.length-1,i=Math.max(d.calcHeight(this.widgets[o].bbox),d.calcHeight(this.widgets[o-1].bbox));this.cursor.y+=i+r.layout_commons.widget_gap}else this.cursor.x+=Math.min(this.tools.max_width,Math.max(this.tools.min_width,d.calcWidth(this.bbox)))/2;break}}render(e){e.save();const o=r.layout_commons.border_width;e.beginPath(),e.rect(this.bbox.left,this.bbox.top,d.calcWidth(this.bbox),d.calcHeight(this.bbox)),e.closePath(),e.fillStyle=w.string(r.layout_commons.bg_color),e.fillRect(this.bbox.left,this.bbox.top,d.calcWidth(this.bbox),d.calcHeight(this.bbox)),e.strokeStyle=r.layout_commons.border,e.lineWidth=o,e.strokeRect(this.bbox.left-.5*o,this.bbox.top-.5*o,d.calcWidth(this.bbox)+o,d.calcHeight(this.bbox)+o),e.clip(),super.render(e),e.restore()}requestAction(e){return e.mouse_position.x,{minimise:!1,close:!1,resize:!1,iters:null,wants_focus:!1,action:null}}requestWindowAction(e,o){const i=super.requestAction(o);return i.iters==null?{minimise:!1,close:!1,resize:!1,...i}:this.widgets[i.iters]instanceof W?{minimise:i.action!=null,close:!1,resize:!1,...i}:this.widgets[i.iters]instanceof O&&!e?{minimise:!1,close:!1,resize:i.action!=null,...i}:this.widgets[i.iters]instanceof L?{minimise:!1,close:i.action!=null,resize:!1,...i}:e?{minimise:!1,close:!1,resize:!1,iters:null,wants_focus:!1,action:null}:{minimise:!1,close:!1,resize:!1,...i}}}class $ extends A{constructor(e,o,i,s,n,c){super(e,o,i,s,n,0);l(this,"columns");this.columns=c}updateBBox(e){const o=r.layout_commons.padding;e.bbox.top<this.bbox.top+o&&(this.bbox.top=e.bbox.top-o),e.bbox.bottom>this.bbox.bottom-o&&(this.bbox.bottom=e.bbox.bottom+o)}pushWidget(e){if(super.pushWidget(e),this.updateBBox(e),this.widgets.length%this.columns==0){let i=Number.NEGATIVE_INFINITY;for(let s=this.widgets.length-this.columns;s<this.widgets.length;s++)this.widgets[s].bbox.bottom>i&&(i=this.widgets[s].bbox.bottom);this.cursor.x=this.bbox.left+r.layout_commons.padding,this.cursor.y=i+r.layout_commons.widget_gap;return}this.cursor.x+=d.calcWidth(this.bbox)/this.columns}render(e){e.fillStyle=w.string(r.layout_commons.bg_color),e.fillRect(this.bbox.left,this.bbox.top,d.calcWidth(this.bbox),d.calcHeight(this.bbox)),e.strokeStyle=r.layout_commons.border,e.lineWidth=1,e.strokeRect(this.bbox.left,this.bbox.top,d.calcWidth(this.bbox),d.calcHeight(this.bbox)),super.render(e)}requestAction(e){const o=i=>{if(e.active_widget_loc.length===0)return!0;const s=e.active_widget_loc.slice(0,i.loc.length);return s.length===i.loc.length&&s.every((n,c)=>n===i.loc[c])};if(!e.moving_window)for(let i=0;i<this.widgets.length;i++){const s=this.widgets[i];if(!o(s))continue;const n=s.requestAction(e);if(n.wants_focus||n.action!=null)return{iters:i,...n}}return{iters:null,wants_focus:!1,action:null}}}class D{constructor(){l(this,"bbox");l(this,"widgets");this.bbox={left:0,right:0,top:0,bottom:0},this.widgets=[]}render(t){t.lineWidth=1}stack_render(t,e){for(let o=e.window_order.length-1;o>=0;o--){const i=e.window_order[o];e.window_active[i]&&this.widgets[i].render(t)}}makeWindow(t,e,o,i){const s=this.widgets.length;e.window_offsets.length<=this.widgets.length&&(e.window_offsets.push({x:0,y:0}),e.window_positions.push({x:i.x??0,y:i.y??0}),e.window_sizes.push({width:i.width??200,height:i.height??200}),e.window_active.push(!0),e.window_minimised.push(!1),e.window_order.unshift(s));const n=new H(t,o.window,o.header,o.resizeable,o.close_btn,[s],e.window_positions[s].x,e.window_positions[s].y,e.window_sizes[s].width,e.window_sizes[s].height,i.title??"Hello, World!",{width:i.min_width??50,height:i.min_height??20});return this.widgets.push(n),n}static makeGrid(t,e,o,i){const s=new $(e,t.loc.concat([t.widgets.length]),t.cursor.x,t.cursor.y+r.layout_commons.padding,i*(t.bbox.right-t.bbox.left-2*r.layout_commons.padding),o);return t.pushWidget(s),s}endEditing(t){for(let e=0;e<this.widgets.length;e++){const o=this.widgets[e];if(t.window_active[e]&&t.window_minimised[e]&&o instanceof H){o.bbox.bottom=o.bbox.top+o.header_height;for(let i=0;i<=2;i++)if(o.widgets[i]instanceof W){o.widgets[i].window_state="minimised";break}}}}requestAction(t){this.endEditing(t);for(let e=0;e<t.window_order.length;e++){const o=t.window_order[e],i=this.widgets[o];if(t.mouse_frame.released&&(t.resizing_window=!1,document.body.style.cursor="default"),!t.window_active[o])continue;const s=i instanceof H?i.requestWindowAction(t.window_minimised[o],t):i.requestAction(t);s.wants_focus&&(t.window_order.splice(e,1),t.window_order.unshift(o));const n=s;if(i instanceof H&&n.iters!=null){if(n.resize&&(t.resizing_window=!0,document.body.style.cursor="nwse-resize"),t.resizing_window&&JSON.stringify(t.active_widget_loc)==JSON.stringify(i.widgets[n.iters].loc)){t.window_sizes[o].width+=t.window_sizes[o].width<i.min_size.width&&t.mouse_delta_pos.x<0?0:t.mouse_delta_pos.x,t.window_sizes[o].height+=t.window_sizes[o].height<i.min_size.height&&t.mouse_delta_pos.y<0?0:t.mouse_delta_pos.y;break}n.close&&(t.window_active[o]=!1),n.minimise&&(t.window_minimised[o]=!t.window_minimised[o]),t.window_minimised[o]&&(i.bbox.bottom=i.bbox.top+d.calcHeight(i.widgets[n.iters].bbox))}if(document.body.style.cursor="default",t.moving_window&&JSON.stringify(t.active_widget_loc)===JSON.stringify(i.loc)){t.mouse_frame.clicked?(t.window_order.splice(e,1),t.window_order.unshift(o),t.window_offsets[o].x=i.bbox.left-t.mouse_position.x,t.window_offsets[o].y=i.bbox.top-t.mouse_position.y):t.mouse_down&&(t.window_positions[o].x=t.window_offsets[o].x+t.mouse_position.x,t.window_positions[o].y=t.window_offsets[o].y+t.mouse_position.y);break}if(!(s.action==null&&(!d.isInside(i.bbox,t.mouse_position.x,t.mouse_position.y)||t.moving_window)))return t.mouse_frame.released&&(t.active_widget_loc=[]),s}return{wants_focus:!1,action:null}}}const I=document.createElement("style");I.type="text/css";I.appendChild(document.createTextNode(`
    @font-face {
    font-family: "Hack Regular";
    font-style: normal;
    font-weight: normal;
    src: local("Hack Regular"), url("/hack-webfont/Hack-Regular.woff") format("woff");
    }
    

    @font-face {
    font-family: "Hack Italic";
    font-style: normal;
    font-weight: normal;
    src: local("Hack Italic"), url("/hack-webfont/Hack-Italic.woff") format("woff");
    }
    

    @font-face {
    font-family: "Hack Bold";
    font-style: normal;
    font-weight: normal;
    src: local("Hack Bold"), url("/hack-webfont/Hack-Bold.woff") format("woff");
    }
    

    @font-face {
    font-family: "Hack Bold Italic";
    font-style: normal;
    font-weight: normal;
    src: local("Hack Bold Italic"), url("/hack-webfont/Hack-BoldItalic.woff") format("woff");
    }`));document.head.appendChild(I);const u=document.createElement("canvas");u.id="imgui.ts-canvas";document.body.appendChild(u);u.style.position="absolute";u.style.top="0px";u.style.left="0px";function V(){u.width=window.innerWidth,u.height=window.innerHeight,u.style.width=window.innerWidth+"px",u.style.height=window.innerHeight+"px"}function k(h,t){return Math.floor(h*10**t)/10**t}function Y(h,t){let e=h%t;return e<0&&(e+=t),e}const p=class p{static isColor(t){return typeof t==typeof p.white}static string(t){return`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`}static fromString(t){const e=t.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*(\d*\.?\d+)?\)/);if(!e)throw new Error("Invalid color string format");const[,o,i,s,n]=e;return{r:parseInt(o,10),g:parseInt(i,10),b:parseInt(s,10),a:n!==void 0?parseFloat(n):1}}static fromHex(t){const e=t.replace("#","");if(e.length===6){const o=parseInt(e.slice(0,2),16),i=parseInt(e.slice(2,4),16),s=parseInt(e.slice(4,6),16);return{r:o,g:i,b:s,a:1}}else if(e.length===8){const o=parseInt(e.slice(0,2),16),i=parseInt(e.slice(2,4),16),s=parseInt(e.slice(4,6),16),n=parseInt(e.slice(6,8),16)/255;return{r:o,g:i,b:s,a:n}}else throw new Error("Invalid hex color format")}static toHex(t){const e=Math.round(t.r).toString(16).padStart(2,"0"),o=Math.round(t.g).toString(16).padStart(2,"0"),i=Math.round(t.b).toString(16).padStart(2,"0"),s=Math.round(t.a*255).toString(16).padStart(2,"0");return t.a===1?`#${e}${o}${i}`:`#${e}${o}${i}${s}`}static fromRGB(t){return{...t,a:1}}static fromHSVA(t,e,o,i){const s=Y(t,360),n=o*e,c=n*(1-Math.abs(s/60%2-1)),a=o-n;let[f,_,m]=[0,0,0];return 0<=s&&s<60?[f,_,m]=[n,c,0]:60<=s&&s<120?[f,_,m]=[c,n,0]:120<=s&&s<180?[f,_,m]=[0,n,c]:180<=s&&s<240?[f,_,m]=[0,c,n]:240<=s&&s<300?[f,_,m]=[c,0,n]:300<=s&&s<360&&([f,_,m]=[n,0,c]),[f,_,m]=[255*(f+a),255*(_+a),255*(m+a)],{r:k(f,this.EPS_DECIMALS),g:k(_,this.EPS_DECIMALS),b:k(m,this.EPS_DECIMALS),a:i}}static toHSVA(t){const e=t.r/255,o=t.g/255,i=t.b/255,s=Math.max(e,o,i),n=Math.min(e,o,i),c=s-n;let a=0;c==0?a=0:s===e?a=(60*((o-i)/c)+360)%360:s===o?a=(60*((i-e)/c)+120)%360:s===i&&(a=(60*((e-o)/c)+240)%360);const f=s===0?0:c/s,_=s;return{h:k(a,this.EPS_DECIMALS),s:k(f,this.EPS_DECIMALS),v:k(_,this.EPS_DECIMALS),a:t.a}}};l(p,"white",{r:255,g:255,b:255,a:1}),l(p,"black",{r:0,g:0,b:0,a:1}),l(p,"g_18",{r:18,g:19,b:18,a:1}),l(p,"red",{r:255,g:0,b:0,a:1}),l(p,"default_bg"),l(p,"EPS_DECIMALS",6);let w=p;class d{static isInside(t,e,o){return e>t.left&&e<t.right&&o>t.top&&o<t.bottom}static calcWidth(t){return t.right-t.left}static calcHeight(t){return t.bottom-t.top}static set(t,e){t.left=e.left,t.right=e.right,t.top=e.top,t.bottom=e.bottom}}class r{}l(r,"font","Hack Regular"),l(r,"widget",{default_bg_color:"#666170FF",hover_bg_color:"#9992A8FF",down_bg_color:"#CCC2E0FF"}),l(r,"label",{font_size:12,default_font_color:w.white,inactive_font_color:w.fromHex("#808080FF")}),l(r,"text",{font_size:12,text_height_mult:1.5}),l(r,"button",{padding:3,font_size:12}),l(r,"layout_commons",{padding:10,widget_gap:5,bg_color:w.fromHex("#0F0F0FF0"),border:"#6E6E8080",border_width:1}),l(r,"header_commons",{color:"#ffffff",bg_color:"#4b4654",font_size:12}),l(r,"window",{minimized_header_bg:"#9F9F9F09"}),l(r,"grid",{}),l(r,"popup",{});class X{constructor(t,e,o){l(this,"mouse_position");l(this,"mouse_prev_position");l(this,"mouse_delta_pos");l(this,"mouse_down_position");l(this,"mouse_down");l(this,"mouse_frame");l(this,"delta_mouse_scroll",{x:0,y:0});l(this,"moving_window");l(this,"resizing_window");l(this,"window_offsets");l(this,"window_positions");l(this,"window_sizes");l(this,"window_active");l(this,"window_minimised");l(this,"window_order");l(this,"active_widget_loc");l(this,"action_ret_var");l(this,"last_click_time");l(this,"double_click_threshold");this.mouse_position={x:e,y:o},this.mouse_prev_position={x:e,y:o},this.mouse_down_position={x:e,y:o},this.mouse_delta_pos={x:e,y:o},this.mouse_down=!1,this.mouse_frame={clicked:!1,time_at_click:-1,time_since_click:0,double_clicked:!1,released:!1},this.delta_mouse_scroll={x:0,y:0},this.moving_window=!1,this.resizing_window=!1,this.window_offsets=[],this.window_positions=[],this.window_sizes=[],this.window_active=[],this.window_minimised=[],this.window_order=[],this.active_widget_loc=[],this.last_click_time=-1,this.double_click_threshold=300,this.action_ret_var=void 0,t.addEventListener("mousemove",i=>{const s=t.getBoundingClientRect(),n=i.clientX-s.x,c=i.clientY-s.y;this.mouse_position.x=n,this.mouse_position.y=c}),t.addEventListener("mousedown",i=>{const s=t.getBoundingClientRect(),n=i.clientX-s.x,c=i.clientY-s.y;this.mouse_down_position.x=n,this.mouse_down_position.y=c;const a=performance.now();this.mouse_frame.clicked=!0,this.last_click_time!==-1&&a-this.last_click_time<this.double_click_threshold?this.mouse_frame.double_clicked=!0:(this.mouse_frame.double_clicked=!1,a-this.last_click_time>=this.double_click_threshold&&(this.last_click_time=-1)),this.last_click_time=a,this.mouse_down=!0}),t.addEventListener("mouseup",()=>{this.mouse_frame.released=!0,this.mouse_down=!1}),t.addEventListener("wheel",i=>{this.delta_mouse_scroll.x=i.deltaX,this.delta_mouse_scroll.y=i.deltaY})}end(){this.mouse_delta_pos.x=this.mouse_position.x-this.mouse_prev_position.x,this.mouse_delta_pos.y=this.mouse_position.y-this.mouse_prev_position.y,this.mouse_prev_position.x=this.mouse_position.x,this.mouse_prev_position.y=this.mouse_position.y;const t=performance.now();this.mouse_frame.time_at_click!==-1&&(this.mouse_frame.time_since_click=t-this.mouse_frame.time_at_click),this.mouse_frame.clicked&&(this.mouse_frame.time_at_click=t),t-this.last_click_time>=this.double_click_threshold&&(this.mouse_frame.time_at_click=-1,this.mouse_frame.time_since_click=0,this.last_click_time=-1),this.mouse_frame.clicked=!1,this.mouse_frame.released=!1,this.mouse_frame.double_clicked=!1,this.delta_mouse_scroll.x=0,this.delta_mouse_scroll.y=0}}const b=u.getContext("2d"),x=new X(u,0,0),g={num:0,bg_color_picker_win:!1,bg_color:w.fromHex("#4ba4c2")};function P(){V();const h=new D,t=h.makeWindow(b,x,{window:0,header:0,resizeable:0,close_btn:null},{title:"Window 1",x:500,y:100,width:600,height:500});t.makeLabel(b,null,"Hello, World!");const e=t.getInnerWidth();t.makeText(b,null,"Hello world! This is written in `win.makeText`. I have written more text here to maybe show of some text-wrapping based on window width...",e),t.makeLabel(b,null,"Two column layout mode:"),t.setMode("two columns"),t.makeButton(b,0,"Left"),t.makeButton(b,0,"Right"),t.makeText(b,null,"Maybe some button description: "+g.num,e/2),t.makeDraggable(b,1,"Draggable"),t.setMode("normal"),t.makeLabel(b,null,""),t.setMode("two columns"),t.makeText(b,null,"Open color picker for background-color: ",e/2),t.makeButton(b,3,"Open"),h.makeWindow(b,x,{window:0,header:0,resizeable:0,close_btn:null},{title:"Window 2",x:100,y:400,width:200,height:200}).makeLabel(b,0,"Hover over me!");let i=[];if(g.bg_color_picker_win){const c=h.makeWindow(b,x,{window:0,header:null,resizeable:null,close_btn:null},{title:"Change background-color",x:70,y:70,width:420,height:430});c.makeColorPickerRect(2,g.bg_color,400,400),i=c.loc}const n=h.requestAction(x).action;switch(i.length!=0&&!K(x.active_widget_loc,i)&&n!=null&&(g.bg_color_picker_win=!1),n){case 0:break;case 1:g.num+=x.mouse_delta_pos.x,g.num<-100&&(g.num=-100),g.num>100&&(g.num=100);break;case 2:w.isColor(x.action_ret_var)&&(g.bg_color=x.action_ret_var,document.body.style.backgroundColor=w.string(g.bg_color));break;case 3:g.bg_color_picker_win=!0;break}b.clearRect(0,0,u.width,u.height),h.stack_render(b,x),x.end(),requestAnimationFrame(P)}P();function K(h,t){const e=Math.min(t.length,h.length);for(let o=0;o<e;o++)if(h[o]!=t[o])return!1;return!0}
